{% extends "utm/base.html" %}

{% block extra_css %}
<style>
    .link-header {
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
        margin-bottom: 20px;
    }

    .link-header h2 {
        margin-bottom: 4px;
    }

    .full-url-box {
        font-family: 'SF Mono', Monaco, monospace;
        font-size: 12px;
        background: #f5f5f5;
        padding: 16px;
        border: 1px solid #e5e5e5;
        border-radius: 4px;
        word-break: break-all;
        margin: 16px 0;
    }

    .detail-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 20px;
        margin-top: 20px;
    }

    .detail-item {
        background: #fafafa;
        padding: 16px;
        border-radius: 4px;
    }

    .detail-item label {
        font-size: 11px;
        text-transform: uppercase;
        color: #888;
        letter-spacing: 0.03em;
        margin-bottom: 4px;
    }

    .detail-item .value {
        font-size: 14px;
        font-weight: 500;
    }

    .meta-info {
        margin-top: 24px;
        padding-top: 24px;
        border-top: 1px solid #e5e5e5;
    }

    .meta-row {
        display: flex;
        gap: 24px;
        font-size: 13px;
        color: #666;
    }

    .danger-zone {
        margin-top: 32px;
        padding: 20px;
        background: #fef2f2;
        border: 1px solid #fca5a5;
        border-radius: 4px;
    }

    .danger-zone h3 {
        color: #991b1b;
        margin-top: 0;
    }
</style>
{% endblock %}

{% block content %}
<div class="card">
    <div class="link-header">
        <div>
            <h2>{{ link.utm_campaign }}</h2>
            <p class="text-muted">{{ link.asset_name or 'Tracked Link' }}</p>
        </div>
        <div>
            <button type="button" class="btn btn-secondary btn-sm" onclick="copyUrl()">Copy URL</button>
            <a href="/utm/library" class="btn btn-secondary btn-sm">Back to Library</a>
        </div>
    </div>

    <div class="full-url-box" id="fullUrl">{{ link.full_url }}</div>

    <div class="detail-grid">
        <div class="detail-item">
            <label>Source</label>
            <div class="value">{{ link.utm_source }}</div>
        </div>
        <div class="detail-item">
            <label>Medium</label>
            <div class="value">{{ link.utm_medium }}</div>
        </div>
        <div class="detail-item">
            <label>Campaign</label>
            <div class="value">{{ link.utm_campaign }}</div>
        </div>
        {% if link.utm_content %}
        <div class="detail-item">
            <label>Content</label>
            <div class="value">{{ link.utm_content }}</div>
        </div>
        {% endif %}
        {% if link.utm_term %}
        <div class="detail-item">
            <label>Term</label>
            <div class="value">{{ link.utm_term }}</div>
        </div>
        {% endif %}
        {% if link.channel %}
        <div class="detail-item">
            <label>Channel</label>
            <div class="value">{{ link.channel }}</div>
        </div>
        {% endif %}
    </div>

    {% if link.description %}
    <div style="margin-top: 24px;">
        <h3>Notes</h3>
        <p style="color: #666;">{{ link.description }}</p>
    </div>
    {% endif %}

    <div class="meta-info">
        <div class="meta-row">
            <span><strong>Canonical URL:</strong> {{ link.canonical_url }}</span>
        </div>
        <div class="meta-row" style="margin-top: 8px;">
            <span><strong>Created:</strong> {{ link.created_at.strftime('%B %d, %Y at %H:%M') }}</span>
            {% if link.created_by %}
            <span><strong>By:</strong> {{ link.created_by }}</span>
            {% endif %}
        </div>
    </div>

    <div class="danger-zone">
        <h3>Danger Zone</h3>
        <p style="margin-bottom: 12px; font-size: 13px;">Deleting this link cannot be undone. The link will still work, but it will be removed from your library.</p>
        <form method="POST" action="/utm/link/{{ link.id }}/delete" onsubmit="return confirm('Are you sure you want to delete this link?');">
            <button type="submit" class="btn btn-danger btn-sm">Delete Link</button>
        </form>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
function copyUrl() {
    const url = document.getElementById('fullUrl').textContent;
    navigator.clipboard.writeText(url).then(() => {
        alert('URL copied to clipboard!');
    });
}
</script>
{% endblock %}

