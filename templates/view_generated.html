{% extends "base.html" %}

{% block extra_css %}
<style>
    .meta-box {
        background: #fafafa;
        border: 1px solid #e5e5e5;
        border-radius: 4px;
        padding: 16px;
        margin: 20px 0;
    }

    .meta-box p {
        font-size: 13px;
        margin: 0 0 6px 0;
        color: #666;
    }

    .meta-box p:last-child {
        margin-bottom: 0;
    }

    .meta-box strong {
        color: #1a1a1a;
    }

    .seo-box {
        background: #fafafa;
        border: 1px solid #e5e5e5;
        border-radius: 4px;
        padding: 16px;
        margin-bottom: 16px;
    }

    .seo-box h3 {
        font-size: 12px;
        text-transform: uppercase;
        letter-spacing: 0.03em;
        color: #888;
        margin: 0 0 12px 0;
    }

    .seo-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
        gap: 16px;
        margin-bottom: 16px;
    }

    .seo-metric {
        font-size: 13px;
    }

    .seo-metric .label {
        color: #888;
        font-size: 11px;
        text-transform: uppercase;
        letter-spacing: 0.02em;
        margin-bottom: 2px;
    }

    .seo-metric .value {
        color: #1a1a1a;
        font-weight: 500;
    }

    .recommendations {
        margin-top: 16px;
        padding-top: 16px;
        border-top: 1px solid #e5e5e5;
    }

    .recommendations h4 {
        font-size: 12px;
        text-transform: uppercase;
        letter-spacing: 0.03em;
        color: #888;
        margin: 0 0 8px 0;
    }

    .recommendations ul {
        margin: 0;
        padding-left: 20px;
    }

    .recommendations li {
        font-size: 13px;
        color: #666;
        margin-bottom: 4px;
    }

    .keywords-box {
        margin-top: 16px;
        padding-top: 16px;
        border-top: 1px solid #e5e5e5;
    }

    .keywords-box h4 {
        font-size: 12px;
        text-transform: uppercase;
        letter-spacing: 0.03em;
        color: #888;
        margin: 0 0 8px 0;
    }

    .keyword-tag {
        display: inline-block;
        background: #fff;
        border: 1px solid #e5e5e5;
        padding: 4px 10px;
        margin: 3px 3px 3px 0;
        border-radius: 3px;
        font-size: 12px;
        color: #666;
    }

    .content-body {
        line-height: 1.7;
        font-size: 14px;
        color: #333;
    }

    .content-body h1,
    .content-body h2,
    .content-body h3 {
        margin-top: 24px;
        margin-bottom: 12px;
    }

    .content-body p {
        margin-bottom: 14px;
    }

    .actions {
        margin-top: 24px;
        padding-top: 24px;
        border-top: 1px solid #e5e5e5;
    }
</style>
{% endblock %}

{% block content %}
<div class="card">
    <h2>{{ content.title }}</h2>

    <div class="meta-box">
        <p><strong>Words:</strong> {{ content.word_count }}</p>
        <p><strong>Generated:</strong> {{ content.generated_at.strftime('%Y-%m-%d %H:%M') if content.generated_at else 'N/A' }}</p>
        {% if content.meta_description %}
        <p><strong>Meta:</strong> {{ content.meta_description }}</p>
        {% endif %}
    </div>

    {% if seo_report %}
    <div class="seo-box">
        <h3>SEO Analysis</h3>

        <div class="seo-grid">
            <div class="seo-metric">
                <div class="label">Score</div>
                <div class="value">
                    <span class="seo-score {% if seo_report.seo_score >= 70 %}high{% elif seo_report.seo_score >= 50 %}medium{% else %}low{% endif %}">
                        {{ seo_report.seo_score }}/100
                    </span>
                </div>
            </div>
            <div class="seo-metric">
                <div class="label">Readability</div>
                <div class="value">{{ seo_report.readability.flesch_reading_ease }}</div>
            </div>
            <div class="seo-metric">
                <div class="label">Headings</div>
                <div class="value">{{ seo_report.headings.total_headings }}</div>
            </div>
            <div class="seo-metric">
                <div class="label">Title Length</div>
                <div class="value">{{ seo_report.title_length }} chars</div>
            </div>
        </div>

        {% if seo_report.recommendations %}
        <div class="recommendations">
            <h4>Recommendations</h4>
            <ul>
                {% for rec in seo_report.recommendations %}
                <li>{{ rec }}</li>
                {% endfor %}
            </ul>
        </div>
        {% endif %}

        {% if seo_report.top_keywords %}
        <div class="keywords-box">
            <h4>Top Keywords</h4>
            <div>
                {% for keyword, count in seo_report.top_keywords[:10] %}
                <span class="keyword-tag">{{ keyword }} ({{ count }})</span>
                {% endfor %}
            </div>
        </div>
        {% endif %}
    </div>
    {% endif %}

    <div class="card" style="margin-bottom: 0;">
        <h3 style="font-size: 12px; text-transform: uppercase; letter-spacing: 0.03em; color: #888; margin-bottom: 16px;">Content</h3>
        <div class="content-body">
            {{ content.content|safe }}
        </div>
    </div>

    <div class="actions">
        <a href="/generated-content" class="btn btn-secondary">‚Üê Back</a>
        <button onclick="copyToClipboard()" class="btn" style="margin-left: 8px;">Copy Content</button>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
function copyToClipboard() {
    const content = `{{ content.content|safe }}`;
    navigator.clipboard.writeText(content).then(() => {
        alert('Copied to clipboard');
    }).catch(err => {
        alert('Failed to copy: ' + err);
    });
}
</script>
{% endblock %}
